# Incorrect access control in the component \controller\UserController.java of jshERP v3.5 allows attackers to arbitrarily reset user account passwords and execute a horizontal privilege escalation attack.
> [description]
> Incorrect access control in the component
> \controller\UserController.java of jshERP v3.5 allows attackers to
> arbitrarily reset user account passwords and execute a horizontal
> privilege escalation attack.
>
> ------------------------------------------
> [Vendor of Product]
> https://github.com/jishenghua/jshERP
>
> ------------------------------------------
>
> [Affected Product Code Base]
> jshERP - <=3.5
>
> ------------------------------------------
>
> [Affected Component]
> The resetPwd method located in jshERP-boot\src\main\java\com\jsh\erp\controller\UserController.java
<img width="2012" height="664" alt="image" src="https://github.com/user-attachments/assets/a77ee0c6-ef51-43fd-991f-d59733b0698d" />

> [Attack Vectors]
> 1. After logging in to the jsh account, select User Management in the system management column on the left column, select any user information, click Reset Password, and use burpsuite to intercept the request package.
>    <img width="1770" height="856" alt="image" src="https://github.com/user-attachments/assets/6467de30-c47f-4fa0-9342-648ad1960129" />
> 2. Change the request path to /jshERP-boot/user/login/../resetPwd, delete the X-Access-Token header, and reset any account password to 123456 by changing the id value in the json parameter, so now we can take over any account.
<img width="1920" height="796" alt="image" src="https://github.com/user-attachments/assets/8d2fbea8-fbfc-4c0a-8f57-63b47f51e701" />

Impact:Take over any account by resetting account passwords horizontally
